<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>The Eclipse RCP Command Framework</title>
<meta http-equiv="Content-Type"
	content="text/html; charset=windows-1252"/>
<link href="../article.css" type="text/css" rel="stylesheet"/>
<link href="../code.css" type="text/css" rel="stylesheet"/>
<style type="text/css">
/* temporarily marker for editing */
.task {
  background-color: #ffff80;
}
</style>
</head>
<body>

<h1>The Eclipse RCP Command Framework</h1>
<div class="summary">
<h2>Summary</h2>
  <p>From beginning on the Eclipse platform was designed for extensibility.
    Therefore nearly every aspect of the workbench's user interface has a
    corresponding contribution mechanism. While the Eclipse workbench has
    evolved from a pure IDE to <i>the RCP platform</i> a big zoo of of extension
    APIs was created for plug-in provider to facilitate the growing user
    interface capabilities. Eclipse 3.3 introduced a new and consolidated
    framework for user interaction with the Eclipse workbench which obsoletes
    several former extension points and interfaces. The glue within this
    framework are so called <i>commands</i>. This comprehensive article is
    targeted towards new Eclipse RCP developers as well as "pre 3.3 Eclipse
    developers" who want to catch up with new RCP patterns. Due to the included
    references and examples it may also serve as a companion for day-to-day
    development tasks.
  </p>
  <p>
    This article applies to the
    <a href="http://www.eclipse.org/projects/project_summary.php?projectid=eclipse">Eclipse Project</a>,
    release 3.4. For corrections and other issues with this article please use bugzilla entry
    <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=223445">#223445</a>.
  </p>
<div class="author">Draft by Marc R. Hoffmann, Mountainminds GmbH &amp; Co. KG</div>
<div class="copyright">Copyright &copy; 2008 Mountainminds GmbH &amp; Co. KG</div>
<div class="date">DRAFT - June, 2008</div>
</div>

<div class="content">

<h2>Contents</h2>

<ul>
  <li class="task">TODO</li>
</ul>

<h2>Introduction</h2>

<p>
  The Eclipse command framework is the result of long-term effort to streamline
  the way how user interaction is contributed to the Eclipse workbench. While
  Eclipse RCP has outgrown the extensible IDE towards a universal platform for
  all kind of technical and business applications more and more UI capabilities
  came into picture. The original APIs for facilitating all these capabilities
  became cumbersome and bloated.
</p>

<h3>The Original Action Contribution Design</h3>

<p>  
  To understand the reasons for introducing a new framework we will take a quick
  tour through the original contribution mechanisms. A good example for lack of
  required flexibility is JFace's
  <code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/action/IAction.html">IAction</a></code>
  interface, which abstracts a particular user action from specific widgets like
  menu items and tool bar buttons: 
</p>

<pre class="java">
  <span class="keyword">interface</span> IAction {
  
    <span class="keyword">void</span> setText(String text);
    <span class="keyword">void</span> setImageDescriptor(ImageDescriptor image);
    <span class="keyword">void</span> setAccelerator(<span class="keyword">int</span> keycode);
    <span class="keyword">void</span> setEnabled(<span class="keyword">boolean</span> enabled);
    <span class="keyword">void</span> run();
    
    <span class="comment">// ... more setters and getters</span>
  }
</pre> 
 
<p>
  Note what aspects are tightly coupled by this type definition: The textual
  label and menu icon, an keyboard accelerator, the enabled state as well as a
  particular implementation of the action which is directly included in the
  <code>run()</code> method. So what if you have different implementations of
  for the same user action depending on the context or even want to allow
  plug-in providers to supply their own specific implementations? What if you
  need to maintain several customizable keyboard accelerator schemes? How can
  the action's enablement dynamically get computed from some properties of the
  selected elements?  
</p>

<p>
  The extension points of the Eclipse workbench UI separate visual aspects from
  the actual action implementation. While icons and labels are declared in the
  extension attributes the actual execution is delegated to
  <code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/IActionDelegate.html">IActionDelegate</a></code>
  implementations. Depending on the placement and activation context different extension
  points must be used:
</p>

<ul>
  <li>
    <b><code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_actionSets.html">org.eclipse.ui.actionSets</a></code>:</b>
    Action sets are contributions to the main menu and tool bar. Some
    abstraction from the implementation is possible by declaring a contributed
    action as <i>retargetable</i>. In this case parts can register local handlers 
    via API.
  </li><li>
    <b><code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_editorActions.html">org.eclipse.ui.editorActions</a></code>:</b>
    This extension point also allows contributions to the main menu and tool
    bar which are bound to a particular editor type. 
  </li><li>
    <b><code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_actionSetPartAssociations.html">org.eclipse.ui.actionSetPartAssociations</a></code>:</b>
    While the former extension point allows editor specific contributions to
    the main menu and tool bar this one provides a similar functionality for
    all parts including views: It controls the visibility of action sets
    depending whether a particular editor or part is active within the workbench
    window. 
  </li><li>
    <b><code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_viewActions.html">org.eclipse.ui.viewActions</a></code>:</b>
    Each view may have a local tool bar and pull-down menu. This is the
    extension point to populate them for particular view types.  
  </li><li>
    <b><code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_popupMenus.html">org.eclipse.ui.popupMenus</a></code>:</b>
    For additions to context menus, either for specific views
    (<code>viewerContribution</code>) or for particular objects wherever they
    appear in the views (<code>objectContribution</code>).</li>
</ul>

<p>
  Placing menu items or tool bar buttons requires the plug-in developer to pick
  the right extension points out of this list. On the other hand workbench
  locations like the status line can not be populated open at all with these
  extension points.
</p>

<h3>Moving to a new Architecture</h3>

<p>
  The deficiencies with the original action framework were well identified long
  time ago. In 2003  
  <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=36968">bug #36968</a> 
  (<i>"Improve action contributions"</i>) has been opened stating that <i>"the
  current action contribution story is diverse and complex, and the interactions
  between key bindings and retargetable actions, unclear"</i>. This bug has a
  reference to a even older issue filed at times when Eclipse bugzilla entries
  had four digit ids only:
  <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=1989">Bug #1989</a> 
  from 2001 is about controlling visibility of menu items.
</p>

<p>
  In 2005 a
  <a href="http://dev.eclipse.org/viewcvs/index.cgi/platform-ui-home/R3_1/contributions-proposal/requestForComments.html?revision=1.3#SWTRenderer">Request
  for Comments by Douglas Pollock</a> identifies &mdash; among a long list of 
  other important requirements &mdash; the main properties a new action
  framework should come with:
</p>

<ol>
  <li><b>Unified concept for contributions to the workbench</b></li>
  <li><b>Clear separation between behavior and presentation in the user interface</b></li>
</ol>

<p>
  The same RFC proposes a framework centered around so called <i>commands</i>,
  which was adopted in several steps. While the resulting <i>command
  framework</i> is a clean and powerful solution it took some time to integrate
  all aspects into the Eclipse workbench. Starting with Eclipse 3.3 it became
  possible to rely on the new framework for most action contributions. Eclipse
  3.4 opened the framework itself for custom extensions. And happily the 
  <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=1989">4-digit bug</a>
  could finally set to <i>resolved</i> in 2007.
</p>

<h3>The Command Framework</h3>

<ul>
  <li class="task">Highlevel overview defining the core terms along with there
    basic concepts</li>
  <li class="task">A chart "triggers - commands - handlers" depicts the core
    players of the framework.  For each subsequent section a hilighted thumbnail
    version of the same chart could depict the focus of the respective section.</li>
  <li class="task">Involved Services</li>
</ul>

<p class="task"> 
 Use cases:
 
 - Place the same Action at different places e.g. Window Menu and Toolbar
 - Have a different implementation for e.g. the "Copy" Command from the
 "Edit" menu depending on the current context

 Solution: Decouple UI-Binding and implementation through so called Commands.
</p>


<h2>Commands</h2>

<ul>
  <li class="task">Purpose and properties</li>
  <li class="task">Declaring commands via API (why?)</li>
  <li class="task">APIs Querying Commands</li>
  <li class="task">Parametrized commands</li>
  <li class="task">Command icons</li>
</ul>

<h3>Declaring Commands</h3>

<p>
  Due to the abstract concept of commands they are typically declared globally
  via extension definitions in <code>plugin.xml</code> files. Therefore most
  commands are available for the entire life cycle of the workbench in all
  contexts. The corresponding extension point 
  <code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_commands.html">org.eclipse.ui.commands</a></code>
  allows declaring commands and group them into categories:
</p>

<pre class="markup">
  &lt;extension point=<span class="const">"org.eclipse.ui.commands"</span>&gt;
     &lt;category name=<span class="const">"User Sessions"</span>
               description=<span class="const">"Management of user sessions"</span>
               id=<span class="const">"com.mountainminds.eclipse.examples.sessions"</span> /&gt;
     &lt;command name=<span class="const">"Login"</span>
              description=<span class="const">"Login a new user"</span>
              id=<span class="const">"com.mountainminds.eclipse.examples.login"</span>
              categoryId=<span class="const">"com.mountainminds.eclipse.examples.sessions"</span> /&gt;
     &lt;command name=<span class="const">"Logout"</span>
              description=<span class="const">"Logout the current user"</span>
              id=<span class="const">"com.mountainminds.eclipse.examples.logout"</span>
              categoryId=<span class="const">"com.mountainminds.eclipse.examples.sessions"</span> /&gt;
  &lt;/extension&gt;
</pre>

<p>
  As you can see a command definition consists of a name and description, a 
  unique identifier and an optional category. There is no reference to an
  specific implementation and no reference to menu items or key bindings for
  the command. See the online documentation for a complete reference of the
  optional attributes of the extension point 
  <code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_commands.html">org.eclipse.ui.commands</a></code>.
</p>

<p>
  Before creating your own command always double-check whether one of the
  existing commands already provides the required semantic. You'll find a
  full list of the command predefined by the <code>org.eclipse.ui</code> bundle
  <a href="#commands_predefined">below</a>. 
</p>

<h3>Defining Commands Programmatically</h3>

<p>
  In special situations you might also use the command service API to define
  commands programmatically. This can be useful if you retrieve the definitions
  from some other source than Eclipse' declarative XML based extensions. Due to
  the abstract nature of commands they typically exist for the entire life time
  of the contributing bundle and will not change dynamically. Therefore the 
  <code>plugin.xml</code> based declaration described above is the typical 
  approach for Eclipse applications. Anyway, here is an example how the
  <code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/runtime/commands/ICommandService.html">ICommandService</a></code>
  can be used to declare our sample category and commands.
</p>

<pre class="java">
  <span class="comment">// Retrieve the Command Service</span>
  ICommandService cs = (ICommandService) serviceLocator.getService(ICommandService.<span class="keyword">class</span>);

  <span class="comment">// Define Our Category</span>
  Category category = cs.getCategory(<span class="string">"com.mountainminds.eclipse.examples.sessions"</span>);
  category.define(<span class="string">"User Sessions"</span>, <span class="string">"Management of user sessions"</span>);

  <span class="comment">// Define Login Command</span>
  Command login = cs.getCommand(<span class="string">"com.mountainminds.eclipse.examples.login"</span>);
  login.define(<span class="string">"Login"</span>, <span class="string">"Login a new user"</span>, category);

  <span class="comment">// Define Logout Command</span>
  Command logout = cs.getCommand(<span class="string">"com.mountainminds.eclipse.examples.logout"</span>);
  logout.define(<span class="string">"Logout"</span>, <span class="string">"Logout the current user"</span>, category);
</pre>

<p>
  See the <a href="#services">section about services</a> below to learn where
  you can retrieve a  
  <code><a href="http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/runtime/commands/ICommandService.html">ICommandService</a></code>
  instance. As command definitions are declared globally, plug-ins that register
  commands programatically are also responsible for cleaning them up at the end
  of their live cycle. So let's behave like a good Eclipse citizen and undefine
  our examples again:  
</p>

<pre class="java">
  cs.getCommand(<span class="string">"com.mountainminds.eclipse.examples.login"</span>).undefine();
  cs.getCommand(<span class="string">"com.mountainminds.eclipse.examples.logout"</span>).undefine();
  cs.getCategory(<span class="string">"com.mountainminds.eclipse.examples.sessions"</span>).undefine();
</pre>


<h3><a name="commands_predefined"/>Predefined Commands</h3>

<p>
  The <code>org.eclipse.ui</code> bundle comes with a set of predefined commands
  in several categories. These commands form the basic user operations of the
  workbench like opening views or saving editors. Most of them are probably
  required by any custom RCP application and have already global command
  handlers associated to them. For example the handler of the <i>Save</i>
  command will delegate to the 
  <a href="http://help.eclipse.org/help33/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/ISaveablePart.html"><code>ISaveablePart.doSave()</code></a>
  method of the active editor.
  
  Other commands might be re-used in local contexts to implement specific
  behavior for a common concept. For example a <i>Order Items</i> view might
  implement a local handler for the <i>Delete</i>
  (<code>org.eclipse.ui.edit.delete</code>) command to remove the selected item
  from the shopping basket. Re-using existing command definitions for
  semantically similar operations is a good coding practice as it will lead to
  applications with consistent user experience: Whenever a particular item can
  be deleted the according command has the same icon, the expected key binding
  (the <code>Delete</code> key) is active and global menu entries like 
  <i>Edit</i>&nbsp;&rarr;&nbsp;<i>Delete</i> are automatically enabled.
</p>

<p>
  The following table list all categories and commands defined by the
  <code>org.eclipse.ui</code> bundle along with the respective command ids. For
  historical reasons the id naming scheme and categorization isn't consistent in
  all places. Unfortunately there are no Java constants for the command ids in
  Eclipse 3.4 (<a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=54581">Issue #54581</a>). 
</p>

<table class="figure">
  <tr><th>Name</th><th>ID</th></tr>
  <tr style="background-color:#cccccc"><td><b>Category File</b></td><td><code>org.eclipse.ui.category.file</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="New"/> New</td><td><code>org.eclipse.ui.newWizard</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Close"/> Close</td><td><code>org.eclipse.ui.file.close</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Close All"/> Close All</td><td><code>org.eclipse.ui.file.closeAll</code></td></tr>
  <tr><td><img src="images/import_wiz.gif" width="16" height="16" alt="Import"/> Import</td><td><code>org.eclipse.ui.file.import</code></td></tr>
  <tr><td><img src="images/export_wiz.gif" width="16" height="16" alt="Export"/> Export</td><td><code>org.eclipse.ui.file.export</code></td></tr>
  <tr><td><img src="images/save_edit.gif" width="16" height="16" alt="Save"/> Save</td><td><code>org.eclipse.ui.file.save</code></td></tr>
  <tr><td><img src="images/saveas_edit.gif" width="16" height="16" alt="Save As"/> Save As</td><td><code>org.eclipse.ui.file.saveAs</code></td></tr>
  <tr><td><img src="images/saveall_edit.gif" width="16" height="16" alt="Save All"/> Save All</td><td><code>org.eclipse.ui.file.saveAll</code></td></tr>
  <tr><td><img src="images/print_edit.gif" width="16" height="16" alt="Print"/> Print</td><td><code>org.eclipse.ui.file.print</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Revert"/> Revert</td><td><code>org.eclipse.ui.file.revert</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Restart"/> Restart</td><td><code>org.eclipse.ui.file.restartWorkbench</code></td></tr>
  <tr><td><img src="images/refresh_nav.gif" width="16" height="16" alt="Refresh"/> Refresh</td><td><code>org.eclipse.ui.file.refresh</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Properties"/> Properties</td><td><code>org.eclipse.ui.file.properties</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Exit"/> Exit</td><td><code>org.eclipse.ui.file.exit</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Move..."/> Move...</td><td><code>org.eclipse.ui.edit.move</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Rename"/> Rename</td><td><code>org.eclipse.ui.edit.rename</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Close Others"/> Close Others</td><td><code>org.eclipse.ui.file.closeOthers</code></td></tr>
  <tr style="background-color:#cccccc"><td><b>Category Edit</b></td><td><code>org.eclipse.ui.category.edit</code></td></tr>
  <tr><td><img src="images/undo_edit.gif" width="16" height="16" alt="Undo"/> Undo</td><td><code>org.eclipse.ui.edit.undo</code></td></tr>
  <tr><td><img src="images/redo_edit.gif" width="16" height="16" alt="Redo"/> Redo</td><td><code>org.eclipse.ui.edit.redo</code></td></tr>
  <tr><td><img src="images/cut_edit.gif" width="16" height="16" alt="Cut"/> Cut</td><td><code>org.eclipse.ui.edit.cut</code></td></tr>
  <tr><td><img src="images/copy_edit.gif" width="16" height="16" alt="Copy"/> Copy</td><td><code>org.eclipse.ui.edit.copy</code></td></tr>
  <tr><td><img src="images/paste_edit.gif" width="16" height="16" alt="Paste"/> Paste</td><td><code>org.eclipse.ui.edit.paste</code></td></tr>
  <tr><td><img src="images/delete_edit.gif" width="16" height="16" alt="Delete"/> Delete</td><td><code>org.eclipse.ui.edit.delete</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Content Assist"/> Content Assist</td><td><code>org.eclipse.ui.edit.text.contentAssist.proposals</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Context Information"/> Context Information</td><td><code>org.eclipse.ui.edit.text.contentAssist.contextInformation</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Select All"/> Select All</td><td><code>org.eclipse.ui.edit.selectAll</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Find and Replace"/> Find and Replace</td><td><code>org.eclipse.ui.edit.findReplace</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Add Bookmark"/> Add Bookmark</td><td><code>org.eclipse.ui.edit.addBookmark</code></td></tr>
  <tr style="background-color:#cccccc"><td><b>Category Navigate</b></td><td><code>org.eclipse.ui.category.navigate</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Go Into"/> Go Into</td><td><code>org.eclipse.ui.navigate.goInto</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Back"/> Back</td><td><code>org.eclipse.ui.navigate.back</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Forward"/> Forward</td><td><code>org.eclipse.ui.navigate.forward</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Up"/> Up</td><td><code>org.eclipse.ui.navigate.up</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Next"/> Next</td><td><code>org.eclipse.ui.navigate.next</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Backward History"/> Backward History</td><td><code>org.eclipse.ui.navigate.backwardHistory</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Forward History"/> Forward History</td><td><code>org.eclipse.ui.navigate.forwardHistory</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Previous"/> Previous</td><td><code>org.eclipse.ui.navigate.previous</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Toggle Link with Editor "/> Toggle Link with Editor </td><td><code>org.eclipse.ui.navigate.linkWithEditor</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Next Page"/> Next Page</td><td><code>org.eclipse.ui.part.nextPage</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Previous Page"/> Previous Page</td><td><code>org.eclipse.ui.part.previousPage</code></td></tr>
  <tr><td><img src="images/collapseall.gif" width="16" height="16" alt="Collapse All"/> Collapse All</td><td><code>org.eclipse.ui.navigate.collapseAll</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Show In"/> Show In</td><td><code>org.eclipse.ui.navigate.showIn</code></td></tr>
  <tr style="background-color:#cccccc"><td><b>Category Window</b></td><td><code>org.eclipse.ui.category.window</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="New Window"/> New Window</td><td><code>org.eclipse.ui.window.newWindow</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="New Editor"/> New Editor</td><td><code>org.eclipse.ui.window.newEditor</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Quick Switch Editor"/> Quick Switch Editor</td><td><code>org.eclipse.ui.window.openEditorDropDown</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Quick Access"/> Quick Access</td><td><code>org.eclipse.ui.window.quickAccess</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Switch to Editor"/> Switch to Editor</td><td><code>org.eclipse.ui.window.switchToEditor</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Show System Menu"/> Show System Menu</td><td><code>org.eclipse.ui.window.showSystemMenu</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Show View Menu"/> Show View Menu</td><td><code>org.eclipse.ui.window.showViewMenu</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Activate Editor"/> Activate Editor</td><td><code>org.eclipse.ui.window.activateEditor</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Maximize Active View or Editor"/> Maximize Active View or Editor</td><td><code>org.eclipse.ui.window.maximizePart</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Minimize Active View or Editor"/> Minimize Active View or Editor</td><td><code>org.eclipse.ui.window.minimizePart</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Next Editor"/> Next Editor</td><td><code>org.eclipse.ui.window.nextEditor</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Previous Editor"/> Previous Editor</td><td><code>org.eclipse.ui.window.previousEditor</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Next View"/> Next View</td><td><code>org.eclipse.ui.window.nextView</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Previous View"/> Previous View</td><td><code>org.eclipse.ui.window.previousView</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Next Perspective"/> Next Perspective</td><td><code>org.eclipse.ui.window.nextPerspective</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Previous Perspective"/> Previous Perspective</td><td><code>org.eclipse.ui.window.previousPerspective</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Close All Perspectives"/> Close All Perspectives</td><td><code>org.eclipse.ui.window.closeAllPerspectives</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Close Perspective"/> Close Perspective</td><td><code>org.eclipse.ui.window.closePerspective</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Close Part"/> Close Part</td><td><code>org.eclipse.ui.file.closePart</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Customize Perspective"/> Customize Perspective</td><td><code>org.eclipse.ui.window.customizePerspective</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Hide Editors"/> Hide Editors</td><td><code>org.eclipse.ui.window.hideShowEditors</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Lock the Toolbars"/> Lock the Toolbars</td><td><code>org.eclipse.ui.window.lockToolBar</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Pin Editor"/> Pin Editor</td><td><code>org.eclipse.ui.window.pinEditor</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Preferences"/> Preferences</td><td><code>org.eclipse.ui.window.preferences</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Reset Perspective"/> Reset Perspective</td><td><code>org.eclipse.ui.window.resetPerspective</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Save Perspective As"/> Save Perspective As</td><td><code>org.eclipse.ui.window.savePerspective</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Show Key Assist"/> Show Key Assist</td><td><code>org.eclipse.ui.window.showKeyAssist</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Toggle Toolbar Visibility"/> Toggle Toolbar Visibility</td><td><code>org.eclipse.ui.ToggleCoolbarAction</code></td></tr>
  <tr style="background-color:#cccccc"><td><b>Category Help</b></td><td><code>org.eclipse.ui.category.help</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Help Contents"/> Help Contents</td><td><code>org.eclipse.ui.help.helpContents</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Help Search"/> Help Search</td><td><code>org.eclipse.ui.help.helpSearch</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Dynamic Help"/> Dynamic Help</td><td><code>org.eclipse.ui.help.dynamicHelp</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Welcome"/> Welcome</td><td><code>org.eclipse.ui.help.quickStartAction</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Tips and Tricks"/> Tips and Tricks</td><td><code>org.eclipse.ui.help.tipsAndTricksAction</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="About"/> About</td><td><code>org.eclipse.ui.help.aboutAction</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Display Help"/> Display Help</td><td><code>org.eclipse.ui.help.displayHelp</code></td></tr>
  <tr style="background-color:#cccccc"><td><b>Category Views</b></td><td><code>org.eclipse.ui.category.views</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Show View"/> Show View</td><td><code>org.eclipse.ui.views.showView</code></td></tr>
  <tr style="background-color:#cccccc"><td><b>Category Perspectives</b></td><td><code>org.eclipse.ui.category.perspectives</code></td></tr>
  <tr><td><img src="images/noicon.gif" width="16" height="16" alt="Show Perspective"/> Show Perspective</td><td><code>org.eclipse.ui.perspectives.showPerspective</code></td></tr>
</table>
<div class="caption">
  <strong>Figure xxx</strong>: Commands defined in plug-in <code>org.eclipse.ui</code>
</div>


<h2>Menu Contributions</h2>

<ul>
  <li class="task">Example 1: "Hello World" command placed at all possible
    locations (base for screenshot above).</li>
  <li class="task">ui.menus extension point</li>
  <li class="task">Addressing scheme</li>
  <li class="task">Reference of all well known menu ids</li>
  <li class="task">Stateful items (toggle, check, radio)</li>
  <li class="task">Dynamic contributions, examples: history, customazible 
    favourites, domain specific items (e.g. related Java types, calendar dates).</li>
  <li class="task">Creating custom controls in toolbars.</li>
  <li class="task">Writing extensible plugins</li>
  <li class="task">In case you're project is an add-on to another product (e.g.
    the Eclipse IDE) try to be un-obtrusive and avoid prominent placement of
    menu items. If users installes several add-ons they would flood their
    workbench windows. Especially Command1, Command2 are most likely unapropriate
    places for add-in programs.  
    Instead try to find appropriate locations where similar
    functionality can already be found and everybody will expect it.
    [TODO: Put on best practices list]</li>
  <li class="task">Eclipse Help Issue: "org.eclipse.ui.any.popup" must read
    "org.eclipse.ui.<b>popup.any</b>"</li>
</ul>

<p>
  An important simplification that comes with the new command framework is the
  way how menus and tool bars can be populated. Now we have a single extension
  mechanism to contribute action items as well as other widgets to all possible
  locations within the workbench window. The following screen shows many
  examples where items can be placed:
</p>

<img src="images/menucontributions.png" alt="Menu Contributions" width="623" height="512" class="figure"/>
<div class="caption">
  <strong>Figure xxx</strong>: Possible menu contributions to the Eclipse workbench
</div>

<p>
  With the new contribution framework the extension point org.eclipse.ui.menus
  is the only mechanism you need to know to populate tool bars and menus of the
  RCP workbench. 
</p>



<h2>Key Bindings</h2>

<h2>Handlers</h2>

<ul>
  <li class="task">Purpose and properties</li>
  <li class="task">Default handler, specific/local handers</li>
  <li class="task">Nested IHandlerService implementations, scope of handlers</li>
  <li class="task">Declaring handlers via extension point</li>
  <li class="task">Declaring handlers via API</li>
  <li class="task">Handler lifecycle</li>
  <li class="task">UI element updates</li>
</ul>

<h2>Expressions</h2>

<ul>
  <li class="task">Complete Reference Where Expressions are used in RCP Extension points.</li>
  <li class="task">Examples for Common Tasks</li>
</ul>

<ul>
  <li><b><code>org.eclipse.core.expressions.definitions</code>:</b> </li>
  <li><b><code>org.eclipse.debug.ui.detailPaneFactories</code>:</b> </li>
  <li><b><code>org.eclipse.debug.ui.launchShortcuts</code>:</b> </li>
  <li><b><code>org.eclipse.debug.ui.memoryRenderings</code>:</b> </li>
  <li><b><code>org.eclipse.ltk.*</code>:</b> </li>
  <li><b><code>org.eclipse.ui.actionSets</code>:</b> </li>
  <li><b><code>org.eclipse.ui.activities</code>:</b> </li>
  <li><b><code>org.eclipse.ui.console.consolePageParticipants</code>:</b> </li>
  <li><b><code>org.eclipse.ui.console.consolePatternMatchListeners</code>:</b> </li>
  <li><b><code>org.eclipse.ui.decorators</code>:</b> </li>
  <li><b><code>org.eclipse.ui.editorActions</code>:</b> </li>
  <li><b><code>org.eclipse.ui.handlers</code>:</b> </li>
  <li><b><code>org.eclipse.ui.menus</code>:</b> </li>
  <li><b><code>org.eclipse.ui.navigator.linkHelper</code>:</b> </li>
  <li><b><code>org.eclipse.ui.navigator.navigatorContent</code>:</b> </li>
  <li><b><code>org.eclipse.ui.popupMenus</code>:</b> </li>
  <li><b><code>org.eclipse.ui.propertyPages</code>:</b> </li>
  <li><b><code>org.eclipse.ui.viewActions</code>:</b> </li>
</ul>

<h4>Example: One ore more elements selected</h4>

<pre>
  &lt;with variable="selection"&gt;
    &lt;count value="+"/&gt;
  &lt;/with&gt;
</pre>

<h4>Example: Only Elements selected that adapt to IResource</h4>


<h4>Example: Exactly one element selected that adapts to IResource</h4>


<h2>Sources</h2>

<ul>
  <li class="task">Custom sources</li>
</ul>

<h2><a name="services"/>Services</h2>

<ul>
  <li class="task">List of involved services</li>
  <li class="task">Where to find <code>IServiceLocator</code>s in the workbench</li>
  <li class="task">Service Nesting</li>
  <li class="task">Custom Services</li>
</ul>


<h2>Contexts</h2>

<h2>Debugging</h2>

<h2>Migrating old Code to the Command Framework</h2>

<ul>
  <li class="task">Adapters for Legacy Actions</li>
  <li class="task">Migrating to the ui.menues extension point</li>
</ul>

<h2>More Topics</h2>

<ul>
  <li class="task">Using Commands in Help Contents</li>
  <li class="task">Commands for non-UI applications</li>
  <li class="task">Stateful contribution items (toggle, check, radio)</li>
</ul>


<h2>Example Plug-ins</h2>

<ul>
  <li class="task">Sample plug-ins demonstrating different kind of contribution
  scenarios, check <code>org.eclipse.ui.examples.contributions</code></li>
  <li class="task">Generic command browser plug-in to explore and debug an
  existing RCP application, Browser: Workbench, Window, Page, View for Service
  Location</li>
</ul>

<h2>Best Practices Check List</h2>

<ul>
  <li>Use the new extension point <code>org.eclipse.ui.menu</code> in favour of
    the former <code>org.eclipse.ui.editorActions</code>, 
    <code>org.eclipse.ui.viewActions</code> and
    <code>org.eclipse.ui.popupMenus</code>.</li>  
  <li>Before defining a new command check for semantically similar global
    command definitions that can be re-used in the specific context.</li>
  <li>Consider using a parameterized command instead of multiple different
    commands in case these commands just describe variations of the same
    behaviour.</li>
  <li>Always register the viewers within your workbench parts (views and
    editors) as selection provider to make the command framework aware of the
    current selection.</li>
</ul>

<h2>References</h2>

<ul>
  <li>Douglas Pollock (2005). Improve Action Contributions. <i>Request for Comments at dev.eclipse.org</i><br/>
    <a href="http://dev.eclipse.org/viewcvs/index.cgi/platform-ui-home/R3_1/contributions-proposal/requestForComments.html?revision=1.3">http://dev.eclipse.org/viewcvs/index.cgi/platform-ui-home/R3_1/contributions-proposal/requestForComments.html?revision=1.3</a></li>
  <li>Paul Webster et al (2007). Platform Command Framwork. <i>wiki.eclipse.org</i><br/> 
    <a href="http://wiki.eclipse.org/Platform_Command_Framework">http://wiki.eclipse.org/Platform_Command_Framework</a></li>
  <li>Paul Webster et al (2008). Command Core Expressions. <i>wiki.eclipse.org</i><br/> 
    <a href="http://wiki.eclipse.org/Command_Core_Expressions">http://wiki.eclipse.org/Command_Core_Expressions</a></li>
  <li>Paul Webster et al (2008). Menu Contributions. <i>wiki.eclipse.org</i><br/> 
    <a href="http://wiki.eclipse.org/Menu_Contributions">http://wiki.eclipse.org/Menu_Contributions</a></li>
  <li>Paul Webster (2007). Menu Extension Mapping. <i>wiki.eclipse.org</i><br/> 
    <a href="http://wiki.eclipse.org/Menus_Extension_Mapping">http://wiki.eclipse.org/Menus_Extension_Mapping</a></li>
  <li>Basic workbench extension points using commands. <i>Eclipse 3.3 Online Help</i><br/>
    <a href="http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/workbench_cmd.htm">http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/workbench_cmd.htm</a></li>
  <li>Tonny Madsen (2007). Working with the menus extension point. <i>blog.rcp-company.com</i><br/>
    <a href="http://blog.rcp-company.com/2007/06/working-with-menus-extension-point.html">http://blog.rcp-company.com/2007/06/working-with-menus-extension-point.html</a></li>
  <li>Karsten Voigt (2008). Configuring and adding menu items in Eclipse V3.3. <i>IBM developerWorks</i><br/>
    <a href="http://www.ibm.com/developerworks/library/os-eclipse-3.3menu/index.html">http://www.ibm.com/developerworks/library/os-eclipse-3.3menu/index.html</a></li>
</ul>

<h2>Feedback</h2>

<p>
  Please use bug entry
  <a href="https://bugs.eclipse.org/bugs/show_bug.cgi?id=223445">223445</a> to
  report any issues with this article.
</p>

</div>
</body>
</html>
